<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jaykumar Ahir | Interactive Data Analyst Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;300;400;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #0077B6;
            --secondary-color: #00B4D8;
            --accent-color: #90E0EF;
            --text-color: #1A1A1A;
            --bg-light: #F8F9FA;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-light); color: var(--text-color); }
        .tab-button {
            transition: all 0.2s;
            border-bottom: 2px solid transparent;
        }
        .tab-button.active {
            border-color: var(--primary-color);
            background-color: white;
            color: var(--primary-color);
            font-weight: 600;
        }
        .year-filter-button {
            transition: all 0.2s;
        }
        .year-filter-button.active {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }
        .section-header { border-left: 5px solid var(--primary-color); }
        .card { transition: transform 0.3s, box-shadow 0.3s; }
        .card:hover { transform: translateY(-3px); box-shadow: 0 10px 15px rgba(0, 119, 182, 0.1); }
        .kpi-value { color: var(--primary-color); }
        .chart-container { position: relative; height: 350px; }
        @media (min-width: 1024px) {
            .chart-container { height: 400px; }
        }
        /* Styling for code block */
        .code-block {
            background-color: #272822; /* Monokai-like dark background */
            color: #f8f8f2;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-family: monospace;
            white-space: pre;
        }
        /* Custom styles for reliable copy message */
        #copy-message {
            visibility: hidden; /* Start hidden */
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
        }
        /* Insight button style */
        .insight-button {
            background-color: #e0f7fa;
            color: var(--primary-color);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            font-size: 14px;
            transition: all 0.2s;
        }
        .insight-button:hover {
            background-color: var(--secondary-color);
            color: white;
            transform: scale(1.1);
        }
        /* Modal Styles */
        #insight-modal-overlay {
            transition: opacity 0.3s;
        }
        #insight-modal-content {
            transition: transform 0.3s;
        }
    </style>
</head>
<body class="min-h-screen" oncontextmenu="return false;">

    <!-- Global Styles Setup -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#0077B6',
                        'secondary-cyan': '#00B4D8',
                        'accent-light': '#90E0EF',
                    },
                }
            }
        }
    </script>

    <div id="app" class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">

        <!-- Header and Bio -->
        <header class="text-center py-12 bg-white rounded-xl shadow-lg mb-10">
            <h1 class="text-5xl font-extrabold text-primary-blue">Jaykumar Ahir</h1>
            <p class="text-xl text-gray-600 mt-2">Data Analyst & Project Coordinator | BI & Process Improvement Specialist</p>
            <div class="mt-4 space-x-4 text-gray-500">
                <a 
                    href="mailto:jayahir1595@outlook.com?subject=Inquiry%20from%20Your%20Data%20Analysis%20Portfolio" 
                    onclick="handleEmailClick(event)" 
                    target="_blank"
                    class="hover:text-primary-blue transition relative group"
                >
                    <i class="fas fa-envelope mr-1"></i> Email
                    <span id="copy-message" class="absolute bg-gray-700 text-white text-xs px-2 py-1 rounded-md -bottom-8 left-1/2 transform -translate-x-1/2 whitespace-nowrap">
                        Copied!
                    </span>
                </a>
                <a href="https://www.linkedin.com/in/iamjayahir" target="_blank" class="hover:text-primary-blue transition"><i class="fab fa-linkedin mr-1"></i> LinkedIn</a>
                <a href="https://github.com/iamjayahir" target="_blank" class="hover:text-primary-blue transition"><i class="fab fa-github mr-1"></i> GitHub</a>
            </div>
        </header>

        <!-- Key Projects & Technical Skills Section -->
        <section id="skills-projects" class="mb-12">
            <h2 class="text-3xl font-bold section-header pl-4 mb-6">Key Projects & Business Impact</h2>
            <div class="grid lg:grid-cols-3 gap-6">
                <!-- Project Highlight -->
                <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-2xl font-semibold text-primary-blue mb-4">Project Highlight: End-to-End SQL BI Pipeline</h3>
                    <p class="text-gray-700 mb-4">
                        This project showcases a complete data analytics pipeline, from raw data to actionable business intelligence. It involved designing and implementing a <strong>Star Schema</strong> data warehouse to process sales data. Using advanced SQL techniques—including <strong>CTEs, Window Functions, and complex joins</strong>—I developed automated reports to analyze customer behavior and product performance. 
                    </p>
                    <p class="font-semibold text-gray-800">Key business insights derived from this project include:</p>
                    <ul class="list-disc list-inside ml-4 text-gray-700 mt-2 space-y-1">
                        <li><strong>Customer Segmentation:</strong> Identified high-value 'VIP' customers, enabling targeted marketing campaigns to improve retention and lifetime value.</li>
                        <li><strong>Product Performance Analysis:</strong> Categorized products into performance tiers ('High Performer', 'Mid-Range'), providing a data-driven basis for inventory management and sales strategy.</li>
                        <li><strong>Trend & Growth Velocity:</strong> Analyzed sales trends over time to understand business velocity, seasonality, and support accurate forecasting.</li>
                    </ul>
                    <p class="mt-4 text-sm text-gray-600">
                        The interactive dashboard and code explorer below provide a live demonstration of this project's outcomes.
                    </p>
                </div>

                <!-- Business Problem & Solution -->
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-2xl font-semibold text-primary-blue mb-4">From Data to Decisions</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <h4 class="font-bold text-gray-800">The Business Challenge:</h4>
                            <p class="text-sm text-gray-600 mt-1">The company faced stagnant revenue growth and needed to identify actionable strategies to enhance customer lifetime value and improve profitability without large-scale marketing expenditure.</p>
                        </div>

                        <div>
                            <h4 class="font-bold text-gray-800">My Analytical Approach:</h4>
                            <p class="text-sm text-gray-600 mt-1">Using the SQL data pipeline, I segmented customers and analyzed purchasing patterns. The analysis revealed two critical findings:</p>
                            <ul class="list-disc list-inside ml-4 text-sm text-gray-600 mt-2 space-y-1">
                                <li>A high-value 'VIP' customer segment drove 60% of revenue but was shrinking.</li>
                                <li>High-margin 'Accessory' products were rarely purchased with core 'Bike' products.</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h4 class="font-bold text-gray-800">The Solution & Impact:</h4>
                            <p class="text-sm text-gray-600 mt-1">Based on these insights, I recommended a two-part strategy:</p>
                            <ol class="list-decimal list-inside ml-4 text-sm text-gray-600 mt-2 space-y-1">
                                <li>Launch a targeted loyalty program for VIPs to increase retention.</li>
                                <li>Implement a "frequently bought together" feature to cross-sell accessories.</li>
                            </ol>
                            <p class="text-sm text-gray-600 mt-2 font-semibold">This data-driven approach provided a clear roadmap to boost both customer loyalty and profit margins.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboard" class="mb-12">
             <!-- KPIs -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                <div class="card bg-white p-5 rounded-lg shadow-md text-center">
                    <i class="fas fa-dollar-sign text-3xl kpi-value mb-2"></i>
                    <p class="text-3xl font-bold kpi-value">$12.5M</p>
                    <p class="text-sm text-gray-500">Total Revenue</p>
                </div>
                <div class="card bg-white p-5 rounded-lg shadow-md text-center">
                    <i class="fas fa-users text-3xl kpi-value mb-2"></i>
                    <p class="text-3xl font-bold kpi-value">18,450</p>
                    <p class="text-sm text-gray-500">Total Customers</p>
                </div>
                <div class="card bg-white p-5 rounded-lg shadow-md text-center">
                    <i class="fas fa-shopping-cart text-3xl kpi-value mb-2"></i>
                    <p class="text-3xl font-bold kpi-value">$2,210</p>
                    <p class="text-sm text-gray-500">Avg. Order Value (AOV)</p>
                </div>
                <div class="card bg-white p-5 rounded-lg shadow-md text-center">
                    <i class="fas fa-chart-line text-3xl kpi-value mb-2"></i>
                    <p class="text-3xl font-bold kpi-value">+20.5%</p>
                    <p class="text-sm text-gray-500">YOY Growth</p>
                </div>
            </div>

            <!-- Charts -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Chart 1: Revenue Trend (Line Graph) -->
                <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-3">
                        <div class="flex items-center gap-3">
                            <h3 class="text-xl font-semibold">Monthly Revenue Trend Analysis</h3>
                            <button class="insight-button" data-insight="revenue">
                                <i class="fas fa-lightbulb"></i>
                            </button>
                        </div>
                         <div id="year-filter" class="flex border border-gray-200 rounded-lg overflow-hidden">
                            <!-- Year filter buttons will be inserted here by JS -->
                        </div>
                    </div>
                    <p class="text-sm text-gray-500 mb-4">Tracking sales volume over time to identify seasonality and growth velocity, crucial for accurate forecasting.</p>
                    <div class="chart-container">
                        <canvas id="revenueTrendChart"></canvas>
                    </div>
                </div>

                <!-- Chart 2: Customer Segmentation (Bar Graph) -->
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="flex items-center gap-3 mb-3">
                         <h3 class="text-xl font-semibold">Customer Segmentation</h3>
                         <button class="insight-button" data-insight="customer">
                            <i class="fas fa-lightbulb"></i>
                        </button>
                    </div>
                    <p class="text-sm text-gray-500 mb-4">Segmentation via SQL CASE statements reveals where retention efforts should focus.</p>
                    <div class="chart-container">
                        <canvas id="customerSegmentChart"></canvas>
                    </div>
                </div>
                
                <!-- Chart 3: Top Product Category (Bar/Custom) -->
                <div class="lg:col-span-3 bg-white p-6 rounded-lg shadow-md">
                    <div class="flex items-center gap-3 mb-3">
                        <h3 class="text-xl font-semibold">Top Product Performance</h3>
                         <button class="insight-button" data-insight="product">
                            <i class="fas fa-lightbulb"></i>
                        </button>
                    </div>
                    <p class="text-sm text-gray-500 mb-4">Analysis from the Product Report shows that 'Bikes' generate the highest revenue, driving inventory and marketing decisions.</p>
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="productCategoryChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Code Explorer Section -->
        <section id="code-explorer" class="mb-12">
            <h2 class="text-3xl font-bold section-header pl-4 mb-6">SQL Project Code Explorer</h2>
            <div class="bg-white rounded-lg shadow-md">
                <!-- Tabs -->
                <div class="flex border-b border-gray-200 flex-wrap">
                    <button id="tab-schema" onclick="showTab('schema')" class="tab-button active px-6 py-3 text-sm">Create Schema</button>
                    <button id="tab-eda" onclick="showTab('eda')" class="tab-button px-6 py-3 text-sm">EDA</button>
                    <button id="tab-advance" onclick="showTab('advance')" class="tab-button px-6 py-3 text-sm">Advanced Analysis</button>
                    <button id="tab-customer" onclick="showTab('customer')" class="tab-button px-6 py-3 text-sm">Customer Report</button>
                    <button id="tab-product" onclick="showTab('product')" class="tab-button px-6 py-3 text-sm">Product Report</button>
                </div>
                
                <!-- Tab Content -->
                <div id="content-schema" class="p-6">
                    <p class="text-gray-600 mb-3">Database initialization, defining **Star Schema** with dimension (`dim_customers`, `dim_products`) and fact (`fact_sales`) tables, including foreign key constraints.</p>
                    <pre class="code-block">
CREATE DATABASE DataWarehouseAnalytics;
USE DataWarehouseAnalytics;

CREATE TABLE dim_customers(
	customer_key INT PRIMARY KEY,
	customer_id INT,
	country NVARCHAR(50),
	gender NVARCHAR(50),
	birthdate DATE
);

CREATE TABLE dim_products(
	product_key INT PRIMARY KEY,
	product_name NVARCHAR(50),
	category NVARCHAR(50),
	subcategory NVARCHAR(50),
	cost INT
);

CREATE TABLE fact_sales(
	order_number NVARCHAR(50),
	product_key INT,
	customer_key INT,
	order_date DATE,
	sales_amount INT,
	quantity TINYINT,
	FOREIGN KEY (customer_key) REFERENCES dim_customers(customer_key),
	FOREIGN KEY (product_key) REFERENCES dim_products(product_key)
);
                    </pre>
                </div>
                
                <div id="content-eda" class="p-6 hidden">
                    <p class="text-gray-600 mb-3">**Exploratory Data Analysis (EDA)** to understand the dataset's structure, scope, and distribution before deep-dive analysis. This involves checking data ranges, unique categories, and basic counts.</p>
                    <pre class="code-block">
/* 1. Database & Table Exploration */
USE datawarehouseanalytics;
SHOW tables;

/* 2. Dimension Exploration: Understand unique categories */

-- Explore all the countries our customers come from
SELECT DISTINCT country FROM dim_customers;

-- Explore all product categories and subcategories
SELECT DISTINCT category, subcategory FROM dim_products ORDER BY category, subcategory;

/* 3. Date Exploration: Understand the time scope of the data */

-- Find the date of the first and last order
SELECT 
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM fact_sales;

-- How many years of order data are available?
SELECT 
    DATEDIFF(MAX(order_date), MIN(order_date)) / 365 AS order_range_years
FROM fact_sales;
    
/* 4. Fact Table Sanity Checks */

-- Total number of customers and products
SELECT 
    COUNT(DISTINCT customer_key) AS total_customers,
    COUNT(DISTINCT product_key) AS total_products
FROM fact_sales;

/* 5. Initial Performance Questions */

-- What are the 5 top-performing products in terms of sales?
SELECT
    p.product_name,
    SUM(f.sales_amount) AS total_revenue
FROM fact_sales f
LEFT JOIN dim_products p ON p.product_key = f.product_key
GROUP BY p.product_name
ORDER BY total_revenue DESC
LIMIT 5;

-- Find the top 10 customers who have generated the highest revenue
SELECT 
    c.customer_key,
    SUM(f.sales_amount) AS total_revenue
FROM fact_sales f 
LEFT JOIN dim_customers c ON c.customer_key = f.customer_key
GROUP BY c.customer_key
ORDER BY total_revenue DESC
LIMIT 10;
                    </pre>
                </div>

                <div id="content-advance" class="p-6 hidden">
                    <p class="text-gray-600 mb-3">Example of **Window Functions (SUM() OVER)** and **CTEs** used for cumulative analysis, showing running totals and moving averages to evaluate business growth velocity.</p>
                    <pre class="code-block">
WITH monthly_sales AS (
    SELECT
        YEAR(order_date) AS order_year,
        MONTH(order_date) AS order_month,
        SUM(sales_amount) AS total_sales
    FROM fact_sales
    GROUP BY 1, 2
)
SELECT 
    order_year,
    order_month,
    total_sales,
    -- Calculate the running total of sales over time
    SUM(total_sales) OVER (ORDER BY order_year, order_month) AS running_total_sales,
    -- Calculate the 3-month moving average of sales
    AVG(total_sales) OVER (
        ORDER BY order_year, order_month
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) AS moving_avg_sales
FROM monthly_sales
ORDER BY order_year, order_month;
                    </pre>
                </div>

                <div id="content-customer" class="p-6 hidden">
                    <p class="text-gray-600 mb-3">Comprehensive query to segment customers into **VIP, Regular, and New** using a CASE statement, and calculate key metrics like Average Order Value and lifespan (used to create the `report_customers` view).</p>
                    <pre class="code-block">
CREATE VIEW report_customers AS
WITH base_query AS (
    SELECT 
        f.order_date, f.sales_amount, f.quantity, c.customer_key,
        ROUND((DATEDIFF(CURRENT_DATE(), c.birthdate) / 365 ),0) AS age
    FROM fact_sales f 
    LEFT JOIN dim_customers c ON c.customer_key = f.customer_key
),
customer_aggregation AS (
    SELECT
        customer_key,
        SUM(sales_amount) AS total_sales,
        COUNT(DISTINCT order_number) AS total_orders,
        ROUND(((DATEDIFF(MAX(order_date), MIN(order_date))/ 365) * 12),0) AS lifespan_months
    FROM base_query
    GROUP BY customer_key
)
SELECT 
    ca.*,
    CASE
        WHEN lifespan_months >= 12 AND total_sales > 5000 THEN 'VIP'
        WHEN lifespan_months >= 12 AND total_sales <= 5000 THEN 'Regular'
        ELSE 'New'
    END AS customer_segment,
    ROUND(total_sales / NULLIF(total_orders, 0), 0) AS avg_order_value
FROM customer_aggregation ca;
                    </pre>
                </div>
                
                <div id="content-product" class="p-6 hidden">
                    <p class="text-gray-600 mb-3">Logic to classify products into **High-Performer, Mid-Range, or Low-Performer** based on `total_sales` and calculate metrics like average monthly revenue (used to create the `product_report` view).</p>
                    <pre class="code-block">
CREATE VIEW product_report AS
WITH base_query AS (
    SELECT 
        f.order_date, f.sales_amount, f.quantity, p.product_key, p.product_name, p.category, p.cost
    FROM fact_sales f 
    LEFT JOIN dim_products p ON p.product_key = f.product_key
), 
product_aggregations AS (
    SELECT
        product_key,
        product_name,
        category,
        cost,
        SUM(sales_amount) AS total_sales,
        ROUND((DATEDIFF(MAX(order_date),MIN(order_date)) / 365) * 12,0) AS lifespan_month
    FROM base_query
    GROUP BY product_key, product_name, category, cost
)
SELECT
    pa.*,
    CASE
        WHEN total_sales > 50000 THEN 'High Performer'
        WHEN total_sales >= 10000 THEN 'Mid-Range'
        ELSE 'Low Performer'
    END AS product_segment,
    ROUND(total_sales / NULLIF(lifespan_month, 0), 1) AS avg_monthly_revenue
FROM product_aggregations pa;
                    </pre>
                </div>

            </div>
        </section>

    </div>
    
    <!-- Insight Modal -->
    <div id="insight-modal-overlay" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
        <div id="insight-modal-content" class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-lg transform scale-95">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-bold text-primary-blue flex items-center gap-2">
                    <i class="fas fa-lightbulb"></i>
                    Power Insight
                </h3>
                <button id="modal-close-button" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
            </div>
            <p id="modal-text" class="text-gray-700"></p>
        </div>
    </div>


    <footer class="text-center py-6 border-t mt-8 text-gray-500 text-sm">
        <p>Portfolio built using HTML, Tailwind CSS, and Chart.js to visualize Advanced SQL Business Intelligence concepts.</p>
    </footer>

    <script>
        // --- Dashboard Initialization and Data ---
        
        const MOCK_DATA = {
            // 2024: Strong Q1, steady growth, strong holiday finish.
            '2024': [820, 850, 920, 940, 930, 980, 1050, 1120, 1100, 1200, 1280, 1400],
            // 2023: Good start, slight summer dip, strong Q4 recovery.
            '2023': [700, 740, 790, 810, 780, 760, 830, 900, 940, 1020, 1100, 1180],
            // 2022: Slower initial growth, accelerating significantly in the second half.
            '2022': [500, 520, 540, 580, 610, 650, 720, 800, 850, 910, 950, 1020],
            customerSegments: [
                { name: 'VIP (High Value)', count: 20 },
                { name: 'Regular', count: 60 },
                { name: 'New (First Year)', count: 20 }
            ],
            productCategories: [
                { category: 'Bikes', revenue: 6500 },
                { category: 'Accessories', revenue: 3500 },
                { category: 'Clothing', revenue: 2000 }
            ]
        };
        
        const POWER_INSIGHTS = {
            revenue: "The year-over-year growth trend is consistently positive, with a noticeable acceleration in Q4 for each year. This suggests strong seasonal sales, likely driven by holiday promotions, and indicates an effective growth strategy.",
            customer: "The 'VIP' segment, though representing only 20% of the customer base, drives a disproportionately high amount of revenue. This highlights the importance of targeted retention marketing and loyalty programs for this high-value group.",
            product: "The 'Bikes' category is the primary revenue driver by a significant margin. This data strongly suggests prioritizing inventory for this category and potentially exploring cross-selling opportunities with high-margin 'Accessories' to maximize profit."
        };

        const segmentColors = ['#0077B6', '#00B4D8', '#90E0EF'];
        let revenueChartInstance = null;
        
        const wrapLabel = (label) => {
            if (label.length <= 16) return label;
            const words = label.split(' ');
            const lines = [];
            let currentLine = '';

            words.forEach(word => {
                if ((currentLine + ' ' + word).length <= 16) {
                    currentLine += (currentLine === '' ? '' : ' ') + word;
                } else {
                    lines.push(currentLine);
                    currentLine = word;
                }
            });
            lines.push(currentLine);
            return lines;
        };

        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };

        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                tooltip: { callbacks: { title: tooltipTitleCallback } }
            }
        };

        // 1. Revenue Trend Chart (Line)
        const renderRevenueTrendChart = (year) => {
            if (revenueChartInstance) {
                revenueChartInstance.destroy();
            }
            const ctx = document.getElementById('revenueTrendChart').getContext('2d');
            const monthLabels = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            
            revenueChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: monthLabels,
                    datasets: [{
                        label: `Total Revenue in ${year} (in Thousands)`,
                        data: MOCK_DATA[year],
                        borderColor: segmentColors[0],
                        backgroundColor: segmentColors[0] + '40',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    ...commonOptions,
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: { display: true, text: 'Revenue (K)' },
                            ticks: { callback: (value) => '$' + value }
                        }
                    },
                    plugins: { ...commonOptions.plugins, legend: { position: 'top' } }
                }
            });
        };

        // 2. Customer Segmentation Chart (Bar)
        const renderCustomerSegmentChart = () => {
            const ctx = document.getElementById('customerSegmentChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: MOCK_DATA.customerSegments.map(s => wrapLabel(s.name)),
                    datasets: [{
                        label: 'Customer Count (%)',
                        data: MOCK_DATA.customerSegments.map(s => s.count),
                        backgroundColor: segmentColors,
                        borderColor: '#ffffff',
                        borderWidth: 2
                    }]
                },
                options: { ...commonOptions, indexAxis: 'y', scales: { x: { title: { display: true, text: 'Percentage of Total Customers' }, max: 100 } }, plugins: { ...commonOptions.plugins, legend: { display: false } } }
            });
        };

        // 3. Product Category Chart (Horizontal Bar)
        const renderProductCategoryChart = () => {
            const ctx = document.getElementById('productCategoryChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: MOCK_DATA.productCategories.map(p => wrapLabel(p.category)),
                    datasets: [{
                        label: 'Revenue (in Thousands)',
                        data: MOCK_DATA.productCategories.map(p => p.revenue),
                        backgroundColor: [segmentColors[0], segmentColors[1], segmentColors[2]],
                    }]
                },
                options: { ...commonOptions, indexAxis: 'y', scales: { x: { beginAtZero: true, title: { display: true, text: 'Revenue (K)' }, ticks: { callback: (value) => '$' + value + 'K' } } }, plugins: { ...commonOptions.plugins, legend: { display: false } } }
            });
        };
        
        window.handleEmailClick = (event) => {
            const emailAddress = 'jayahir1595@outlook.com';
            const messageElement = document.getElementById('copy-message');
            const tempInput = document.createElement('input');
            tempInput.value = emailAddress;
            document.body.appendChild(tempInput);
            tempInput.select();
            
            try {
                document.execCommand('copy');
                messageElement.style.visibility = 'visible';
                messageElement.style.opacity = '1';
                setTimeout(() => {
                    messageElement.style.opacity = '0';
                    setTimeout(() => messageElement.style.visibility = 'hidden', 300);
                }, 1500);
            } catch (err) {
                console.error('Could not copy text: ', err);
            } finally {
                document.body.removeChild(tempInput);
            }
            return true; 
        };

        // --- Tab Logic ---
        window.showTab = (tabName) => {
            const contents = ['schema', 'eda', 'customer', 'product', 'advance'];
            contents.forEach(id => {
                document.getElementById('content-' + id).classList.add('hidden');
                document.getElementById('tab-' + id).classList.remove('active');
            });

            document.getElementById('content-' + tabName).classList.remove('hidden');
            document.getElementById('tab-' + tabName).classList.add('active');
        };

        // --- Initialize App ---
        document.addEventListener('DOMContentLoaded', () => {
            renderCustomerSegmentChart();
            renderProductCategoryChart();

            // Setup Year Filter
            const yearFilterContainer = document.getElementById('year-filter');
            const years = Object.keys(MOCK_DATA).filter(k => !isNaN(k));
            const latestYear = Math.max(...years.map(Number)).toString();

            years.reverse().forEach(year => {
                const button = document.createElement('button');
                button.textContent = year;
                button.className = 'year-filter-button px-4 py-1.5 text-sm';
                if (year === latestYear) button.classList.add('active');
                button.onclick = () => {
                    document.querySelectorAll('.year-filter-button').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    renderRevenueTrendChart(year);
                };
                yearFilterContainer.appendChild(button);
            });
            renderRevenueTrendChart(latestYear);
            
            // Setup Modal Logic
            const modalOverlay = document.getElementById('insight-modal-overlay');
            const modalContent = document.getElementById('insight-modal-content');
            const modalText = document.getElementById('modal-text');
            const closeButton = document.getElementById('modal-close-button');
            
            document.querySelectorAll('.insight-button').forEach(button => {
                button.addEventListener('click', () => {
                    const insightKey = button.dataset.insight;
                    modalText.textContent = POWER_INSIGHTS[insightKey];
                    modalOverlay.classList.remove('hidden');
                    modalOverlay.classList.add('flex');
                    setTimeout(() => {
                        modalOverlay.classList.remove('opacity-0');
                        modalContent.classList.remove('scale-95');
                    }, 10);
                });
            });

            const closeModal = () => {
                modalOverlay.classList.add('opacity-0');
                modalContent.classList.add('scale-95');
                setTimeout(() => {
                    modalOverlay.classList.add('hidden');
                    modalOverlay.classList.remove('flex');
                }, 300);
            };

            closeButton.addEventListener('click', closeModal);
            modalOverlay.addEventListener('click', (e) => {
                if (e.target === modalOverlay) closeModal();
            });

            // --- Anti-Copying Measures ---
            document.addEventListener('keydown', event => {
                if (event.ctrlKey && ['c', 'u', 's'].includes(event.key.toLowerCase())) {
                    event.preventDefault();
                }
            });
        });
    </script>
</body>
</html>

